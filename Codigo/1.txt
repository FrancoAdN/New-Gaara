CREATE DATABASE empleados;
CREATE TABLE empleados(
	dni VARCHAR(8);
	nombre NVARCHAR(100);
	apellidos NVARCHAR(255);
	departamento INT;
	PRIMARY KEY (dni)
	FOREING KEY (departamentos) REFERENCES departamentos(codigo));
CREATE TABLE departamentos(
	codigo INT;
	nombre NVARCHAR(100);
	presupuesto INT;
        sueldo INT;S
	PRIMARY KEY(codigo)
	);

SELECT apellidos count (*) from empleados group by apellidos;
SELECT DISTINCT apellidos FROM empleados WHERE apellidos LIKE dni;

SELECT apellidos FROM empleados WHERE Apellidos LIKE 'Lopez';
SELECT apellidos FROM empleados WHERE Apellidos LIKE 'Lopez' AND 'Perez';

SELECT * FROM empleados WHWERE departamento LIKE 14;
SELECT * FROM empleados WHERE departamento LIKE 37 AND 77;
SELECT * FROM empleados WHERE apellido LIKE 'P%';
SELECT SUM (presupuesto) as totalpresupuesto,departamento FROM departamentos GROUP BY departamento;
SELECT COUNT (dni) as totalempleados,departamento FROM empleados 
SELECT nombre,apellidos FROM empleados WHERE codigo IN (SELECT presupuesto FROM departamentos WHERE presupuesto>SUM(60.000));
SELECT * FROM departamentos WHERE presupuesto>AVG(presupuesto);
SELECT departamento FROM empleados WHERE codigo IN (SELECT nombre FROM departamentos WHERE codigo>2) GROUP by departamento 

UPDATE departamentos SET sueldo=10000 
UPDATE departamentos SET sueldo=11000 WHERE codigo=2
DELETE FROM empleados  WHERE apellidos=Perez

SELECT SUM(sueldo) as total FROM departamentos ORDER BY nombre
DELETE FROM departamentos WHERE presupuesto

SELECT nombre FROM empleados WHERE codigo IN (SELECT sueldo FROM departamentos WHERE sueldo>10500) DISTINT departamento=ventas